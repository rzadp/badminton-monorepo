% !TeX root = ../../main.tex
\chapter{Problem wykrywania kortów}

\section{Typy detekcji obiektów na obrazie}
\label{sec:typy_detekcji}

Wykrycie obiektu na obrazie można rozumieć jako cztery podobne problemy.
W kolejności od najbardziej podstawowego do najbardziej szczególnego zadania są to:

\begin{enumerate}
	\item klasyfikacja - polega na stwierdzeniu, czy i jaki obiekt został wykryty na obrazie;
  \item semantyczna segmentacja - polega na wskazaniu które piksele obrazu należą do wykrytego obiektu.
        W przypadku więcej niż jednego obiektu, nie ma rozróżnienia które piksele dotyczą którego obiektu;
	\item detekcja obiektów - polega na wskazaniu gdzie na obrazie znajdują się wykryte obiekty, z~rozróżnieniem poszczególnych obiektów jednak bez wskazania konkretnych pikseli;
	\item segmentacja instancji - polega na wskazaniu konkretnych pikseli wykrytych obiektów z~rozróżnieniem poszczególnych obiektów.
\end{enumerate}

Niniejsza praca zajmuje się tym ostatnim zadaniem, to znaczy segmentacaj instancji kortów do badmintona.

\section{Metody detekcji obszaru kortu}

\TODO{
  (przeglad literatury - opis na kartce)
}

\subimport{}{przeglad}

\section{Metoda detekcji przy użyciu Mask R-CNN}

\subsection{Wyzwania}

W rozwiązaniu zagadnienia detekcji kortów przy użyciu sieci neuronowych problem stanowią:

\begin{itemize}
  \item Ekspozycja kortu
  \item Zbiór treningowy
  \item Czas treningu
\end{itemize}

Poniżej szczegółowe wyjaśnienie.

\subsection*{Ekspozycja kortu}

Podczas gry, kort nigdy nie jest wyeksponowany całkowicie - przesłaniają go gracze, słupki, siatka, sędzia wraz z~jego stanowiskiem, lotka w ruchu.
Dodatkowo w przypadku użycia klatek z~transmisji telewizyjnych, często w postprodukcji na obszar kortu nałożona jest reklama czy logo organizatora meczu.
Rozwiązanie musi być odporne na takie artefakty.

\subsection*{Zbiór treningowy}

Wytrenowanie sieci neuronowej dla złożonych zadań typowo wymaga dużej liczby rekordów w zbiorze treningowym aby uzyskać dobre wyniki.
Trening sieci wykrywającej kort prawdopodobnie wymagałby setek lub tysięcy zdjęć treningowych.
Przygotowanie tak licznego zbioru jest problematyczne ponieważ:

\begin{itemize}
	\item w Internecie nie ma wystarczającej liczby takich obrazów;
	\item wykonanie zdjęć samemu w jednej lokalizacji nie jest wystarczające, ponieważ lokalizacje różnią się miedzy sobą odległością między kortami, kolorem podłogi i kolorem samego kortu, siatką czy wyglądem stanowiska sędziowskiego.
\end{itemize}

\subsection*{Czas treningu}

Trening dużej sieci neuronowej przy użyciu jednej karty GPU potrafi zająć dziesiątki godzin.
Jest to duża przeszkoda w eksprymentach z~różnymi zbiorami treningowymi, hiperparametrami czy zmianami architektury sieci.
