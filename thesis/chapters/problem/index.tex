% !TeX root = ../../main.tex
\chapter{Problem wykrywania kortów}

W niniejszym rozdziale omówiony zostanie dokładniej problem wykrywania kortów na obrazie.
Przedstawione zostaną cztery różne problemy, które można rozumieć jako problem wykrycia obiektów na obrazie.
Następnie zarysowana zostanie metoda detekcji, która obecnie wykorzystywana jest w firmie \blue.
W końcu poruszony zostanie temat wykrycia obrazu przy użyciu sieci neruonowych.

\section{Typy detekcji obiektów na obrazie}
\label{sec:typy_detekcji}

Wykrycie obiektu na obrazie można rozumieć jako cztery podobne problemy.
W kolejności od najbardziej podstawowego do najbardziej szczególnego zadania są to:

\begin{enumerate}
	\item klasyfikacja - polega na stwierdzeniu przynależności wykrytego na obrazie obiektu do jednej z wcześniej zdefiniowanych grup;
  \item semantyczna segmentacja - polega na wskazaniu które piksele obrazu należą do wykrytego obiektu.
        W przypadku więcej niż jednego obiektu, nie ma rozróżnienia które piksele dotyczą którego obiektu;
	\item detekcja obiektów - polega na wskazaniu gdzie na obrazie znajdują się wykryte obiekty, z~rozróżnieniem poszczególnych obiektów jednak bez wskazania konkretnych pikseli;
	\item segmentacja instancji - polega na wskazaniu konkretnych pikseli wykrytych obiektów z~rozróżnieniem poszczególnych obiektów.
\end{enumerate}

Niniejsza praca zajmuje się tym ostatnim zadaniem, to znaczy segmentacją instancji kortów do badmintona.

\section{Metody detekcji obszaru kortu}
\label{sec:metody_detekcji}

Koncentrując się na problemie segmentacji instancji, omówiona zostanie algorytmiczna metoda wykorzystywana w firmie \blue oraz podejście z użyciem sieci neuronowych. \\

\TODO{
  (przeglad literatury - opis na kartce)
}

\subimport{}{przeglad}

\section{Metoda detekcji przy użyciu Mask R-CNN}

\subsection{Wyzwania}

W rozwiązaniu zagadnienia detekcji kortów przy użyciu sieci neuronowych problem stanowią:

\begin{itemize}
  \item Ekspozycja kortu
  \item Zbiór treningowy
  \item Czas treningu
\end{itemize}

Poniżej szczegółowe wyjaśnienie.

\subsection*{Ekspozycja kortu}

Podczas gry, kort nigdy nie jest wyeksponowany całkowicie - przesłaniają go gracze, słupki, siatka, sędzia wraz z~jego stanowiskiem, lotka w ruchu.
Dodatkowo w przypadku użycia klatek z~transmisji telewizyjnych, często w postprodukcji na obszar kortu nałożona jest reklama czy logo organizatora meczu.
Rozwiązanie musi być odporne na takie artefakty.

\subsection*{Zbiór treningowy}

Wytrenowanie sieci neuronowej dla złożonych zadań wymaga dużej liczby rekordów w zbiorze treningowym, aby uzyskać satysfakcjonujące wyniki.
Trening sieci wykrywającej kort prawdopodobnie wymagałby setek lub tysięcy zdjęć treningowych.
Przygotowanie tak licznego zbioru jest problematyczne, ze względu na to że:

\begin{itemize}
	\item brakuje ogólnodostępnych baz z takimi danymi;
	\item firma posiada dane z jednej lokalizacji, a to jest niewystarczające, ponieważ lokalizacje różnią się miedzy sobą odległością między kortami, kolorem podłogi i kolorem samego kortu, siatką czy wyglądem stanowiska sędziowskiego.
\end{itemize}

\subsection*{Czas treningu}

Trening dużej sieci neuronowej przy użyciu jednej karty GPU potrafi zająć dziesiątki godzin.
Jest to duża przeszkoda w eksprymentach z~różnymi zbiorami treningowymi, hiperparametrami czy zmianami architektury sieci.
