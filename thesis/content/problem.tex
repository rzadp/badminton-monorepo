\chapter{Problem wykrycia kortu}

Wykrycie kortu można rozumieć jako cztery podobne problemy. W kolejności od najbardziej podstawowego do najbardziej szczególnego zadania są to:

\begin{enumerate}
	\item Klasyfikacja - Polega na stwierdzeniu, czy i jaki obiekt został wykryty na obrazku.
	\item Semantyczna segmentacja - Polega na wskazaniu które piksele obrazka należą do wykrytego obiektu. W przypadku więcej niż jednego obiektu, nie ma rozróżnienia które piksele dotyczą którego obiektu.
	\item Detekcja obiektów - Polega na wskazaniu gdzie na obrazku znajdują się wykryte obiekty, z rozróżnieniem poszczególnych obiektów jednak bez wskazania konkretnych pikseli.
	\item Segmentacja instancji - Polega na wskazaniu konkretnych pikseli wykrytych obiektów z rozróżnieniem poszczególnych obiektów.
\end{enumerate}

Niniejsza praca zajmuje się tym ostatnim zadaniem, to znaczy segmentacaj instancji kortów do badmintona.

\section{Motywacja}

Praca była pisana przy współpracy z firmą BLUE, która zajmuje się sędziowaniem meczy badmintona i pracuje nad automatyzacją tego zagadnienia. Wymaga to między innymi śledzenia toru lotu lotki, śledzenia zawodników, wykrycia kortu. Konkretne piksele kortu potrzebne są do rozstrzygania wątpliwości w kwestii autu. \\

W polu widzenia kamery często znajduje się więcej niż jeden kort, stąd semantyczna segmentacja nie jest wystarczająca i wymagana jest segmentacja instancji.

\section{Wyzwania}

W rozwiązaniu problemu detekcji kortów przy użyciu sieci neuronowych przeszkodę stanowią wymienione niżej zagadnienia.

\subsection*{Ekspozycja kortu}

Podczas gry, kort nigdy nie jest wyeksponowany całkowicie - przesłaniają go gracze, słupki, siatka, sędzia wraz z jego stanowiskiem, latająca lotka. Dodatkowo w przypadku użycia klatek z transmisji telewizyjnych, często w postprodukcji na obszar kortu nałożona jest reklama czy logo organizatora meczu. Rozwiązanie musi być odporne na takie artefakty.

\subsection*{Zbiór treningowy}

Wytrenowanie sieci neuronowej dla złożonych zadań typowo wymaga dużej liczby rekordów w zbiorze treningowym aby uzyskać dobre wyniki. Trening sieci wykrywającej kort prawdopodobnie wymagałby setek lub tysięcy zdjęć treningowych. Przygotowanie tak licznego zbioru jest problematyczne ponieważ:

\begin{itemize}
	\item W Internecie nie ma wystarczającej liczby takich obrazków
	\item Wykonanie zdjęć samemu w jednej lokalizacji nie jest wystarczające, ponieważ lokalizacje różnią się miedzy sobą odległością między kortami, kolorem podłogi i kolorem samego kortu, siatką czy wyglądem stanowiska sędziowskiego.
\end{itemize}

\subsection*{Czas treningu}

Trening dużej sieci neuronowej przy użyciu jednej karty GPU potrafi zająć dziesiątki godzin. Jest to duża przeszkoda w eksprymentach z różnymi zbiorami treningowymi, hiperparametrami czy zmianami architektury sieci.

\section{Generalizacja}

Praca skupia się na problemie detekcji kortu do badmintona, ale porusza też zagadnienie generalizacji rozwiązania na inne sporty z kortem, jak na przykład tenis ziemny.
